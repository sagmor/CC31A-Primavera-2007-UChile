<html>
<head>
<title>CC31A Tarea 5 </title>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html">
</head>
<BODY BACKGROUND="icons/fondo5.jpg">
<br>
<center>
<h1>Tarea 5 CC31A</h1>
<br>
<h2>Plazo: 2 semanas</h2>

<img src="icons/linea.jpg">
</center>

<h2>Descripción</h2>
<p>
Hacer un programa en C que mueva varios gusanos en una ventana <i>wish</i>,
como un juego tipo <i>snake</i> siguiendo las instrucciones de un programa.
Cada gusano debe moverse solo (cada 0.1 segundo), siguiendo las instrucciones
dadas por un archivo de instrucciones y está implementado por un thread
independiente.

El programa principal debe esperar la muerte de todos los gusanos para terminar.
<p>
Se debe usar la tarea4 de modo de re-utilizar lo hecho hasta ahora en la
programación del gusano. Le agregamos las funcionalidades siguientes:

<p>
Ejecución:
<br>
% ./gusano prog1 prog2 prog3 ...
<br>
donde se crea un thread por cada programa que ejecuta un gusano (máximo 7)
siguiendo las
instrucciones de cada programa (se puede repetir el mismo archivo varias veces).
Los colores de los gusanos son:
<br>
"red", "blue", "green", "black", "white", "yellow", "orange"
<p>
Se agrega una opción -d para que, usando la función tee, el programa muestre
en su salida estándar todos los comandos enviados al wish al mismo tiempo que
se envían al pipe, para hacer debugging.

<p>
ctrl-c ahora debe detener TODOS los threads, por lo que no basta invocar 
pause() sino que hay que anotar esto y cada thread bloquearse esperando
que la reanuden con un segundo ctrl-c.

<p>
sigpipe ahora mata TODOS los gusanos, liberando la memoria completa para que
valgrind sea feliz.

<p>
Sincronización entre gusanos: un choque consigo mismo da muerte al gusano,
el choque con otro gusano me deja bloqueado esperando que se mueva, pero para
evitar un deadlock infinito, esa espera es de máximo 10 segundos (ver 
pthread_cond_timedwait). Después de 10 segundos bloqueado el gusano debe
morir. Todo el acceso a los movimientos (tablero, wish, etc)
debe estar protegido por un mutex común para evitar inconsistencias.

<h2>Gusano</h2>
<p>
Para que vean la salida exacta a implementar por su programa, se les
provee un .tgz con todo lo anterior, un
ejecutable linux/i386 y un Makefile en <a href="tarea5.tgz">tarea5.tgz</a>.

<p>
Luego de extraer todos los archivos, deben ejecutar el programa como:
<pre>
% ./gusano [-d] prog1 prog2 ...
</pre>

<p>
El archivo <a href="gus_prog">gus_prog</a> tiene un
ejemplo de programa simple de control "inteligente" del gusano que esta
tarea debe saber interpretar.

<br>
<h2>Condiciones de Entrega</h2>
<p>
La tarea debe entregarse antes del plazo final a través de U-cursos
y debe compilar sin errores y 
ejecutar, o no será evaluada. Si tienen una tarea que funciona en parte, pero
no completa, entréguenla a tiempo y obtendrán algo de nota.

<p>
Entreguen un tgz completo de todo lo necesario para compilar su tarea, sin
necesidad de
incluir wish.c, wish.h, listas.c, listas.h ni gusano_orig.c que no deben 
modificarse.
<br>
<br>
</html>
